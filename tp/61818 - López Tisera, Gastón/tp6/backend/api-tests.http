### ========================================
### API E-Commerce - Tests REST Client
### ========================================
### 
### Este archivo contiene pruebas para todos los endpoints de la API.
### Usa la extensión REST Client de VSCode para ejecutar las peticiones.
### 
### Presiona "Send Request" sobre cada petición o usa:
### - Ctrl+Alt+R (Windows/Linux) 
### - Cmd+Alt+R (Mac)
###

@baseUrl = http://127.0.0.1:8000/api/v1
@contentType = application/json

### Guardar token luego del login
# @token = tu_token_aqui

### Health
GET {{baseUrl}}/health
Accept: {{contentType}}

### Productos - listar
GET {{baseUrl}}/productos
Accept: {{contentType}}

### Productos - búsqueda por texto
GET {{baseUrl}}/productos?search=mochila
Accept: {{contentType}}

### Productos - filtrar por categoría exacta
GET {{baseUrl}}/productos?categoria=Electrónica
Accept: {{contentType}}

### Productos - detalle
GET {{baseUrl}}/productos/1
Accept: {{contentType}}

### Auth - registrar
POST {{baseUrl}}/auth/register
Content-Type: {{contentType}}

{
  "nombre": "Juan Pérez",
  "email": "juan@example.com",
  "password": "secreto123"
}

### Auth - login (usa @token abajo)
# @name login
POST {{baseUrl}}/auth/login
Content-Type: {{contentType}}

{
  "email": "juan@example.com",
  "password": "secreto123"
}

@token = {{login.response.body.access_token}}

### Auth - perfil actual
GET {{baseUrl}}/auth/me
Accept: {{contentType}}
Authorization: Bearer {{token}}

### Carrito - obtener
GET {{baseUrl}}/carrito
Accept: {{contentType}}
Authorization: Bearer {{token}}

### Carrito - agregar producto
POST {{baseUrl}}/carrito
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "producto_id": 1,
  "cantidad": 2
}

### Carrito - totales
GET {{baseUrl}}/carrito/totales
Accept: {{contentType}}
Authorization: Bearer {{token}}

### Carrito - finalizar compra
POST {{baseUrl}}/carrito/finalizar
Content-Type: {{contentType}}
Authorization: Bearer {{token}}

{
  "direccion": "Siempre Viva 742",
  "tarjeta": "4111111111111111"
}

### Carrito - cancelar
POST {{baseUrl}}/carrito/cancelar
Content-Type: {{contentType}}
Authorization: Bearer {{token}}
